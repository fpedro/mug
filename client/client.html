<head>
  <title>Multiplayer Ultimatum Game</title>
</head>

<body>
  {{> mainPage}}
</body>

<template name="mainPage">

  <!-- navigaion bar -->
  <nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="#">Multiplayer Ultimatum Game</a>
        {{#if currentUser}}
          {{> userInformation}}
        {{else}}
          {{> loginSection}}
        {{/if}}
      </div>
    </div>
  </nav>

  <!-- main section -->
  <div name="main" class="container" style="padding-top:30px;">
    <div name="informations" align="center">
      {{#if currentUser}}
        <!--{{> userInformation}}-->
      {{else}}
        <h3> Welcome to this behavioral experiment.</h3><br>
        <h4> Please sign in with the username and password that were given to you.</h4>
        <img src="game-theory.jpg" style="padding-top:40px">
      {{/if}}  
      <br>
    </div>
  
    <div name="content" align="center">
      {{#if currentUser}}
        {{#if displayInformation}}
          {{> displayInfo}}
        {{else}}
          {{> adminArea}}
          {{> gameArea }}
        {{/if}}
      {{/if}}
    </div>
    
    <div name="footer" align="center" style="padding-top:50px" >
      <div style="font-size:10px"></div>
      <div style="font-size:10px">@2014</div>
    </div>
  </div>
</template>

<template name="displayInfo">
  <h4> The rules of the game are simple.... Please click continue so you can be assigned to a group and start playing</h4>
  <button type="submit" class="btn btn-default"  id="quitInformationPanel" >continue</button>
</template>

<template name="userInformation">
  <p class="navbar-text">welcome {{currentUser.username}}</p>
  <form class="navbar-form navbar-left" role="search">
    <button type="submit" class="btn btn-default"  id="logOutButton" >logout</button>
  </form>
    <ul class="nav navbar-nav">
      <li> <a href="#" id="displayInformation">informations</a> </li>
    </ul>
</template>

<template name="adminArea">
  {{#if show}}
  <div>
    {{> createUser}}
    {{> groupCapacity}}
    {{> createSession}}
  </div>
  {{/if}}
</template>
      
<template name="gameArea">
  {{#if show}}
    {{#if groupIsFull}}
      {{#if strategiesInserted}}
        {{#if allGroupResponded}}
          {{#if rewardComputed}}
            <h1> your reward this round: {{roundReward}} </h1>
            {{#if allRoundsPlayed}}
              <div> your total reward: {{totalReward}} </div>
              <div> thank you for your participation. form? </div>
            {{else}}
                <input id="playNextRound" type="submit" value="play next round">
            {{/if}}
          {{else}}
            <input id="updateRoundReward" type="submit" value="compute reward">
          {{/if}}
        {{else}}
          {{> waitOtherStrategies}}
        {{/if}}
      {{else}}
        {{> introduceStrategy}}
      {{/if}}
    {{else}}
      <h4> Wait for other players... </h4>
      <h5> In this game room, so far: </h5>
      {{#each groupMates}}
        <div> {{idPlayer}} </div>
      {{/each}}
    {{/if}}
  {{/if}}
  
</template>

<template name="waitOtherStrategies">
  <h1> wait other strategies </h1>
</template>

<template name="createUser">
  {{> listOfUsers}}
  {{> players}}
  <!--<h3> Create new user </h3>
  <form aligh="center">
    <input id="newUserId" type="text" value="name" onfocus="if (this.value=='name') this.value=''"><br>
    <input id="newUserSessionId" type="text" value="session" onfocus="if (this.value=='session') this.value=''"><br>
    <input id="createNewUser" type="submit" value="create user">
  </form>-->
</template>

<template name="createSession">
  <h3> Create new session </h3>
  <form role="form">
    <div class="form-group" style="width:20%">
    <input id="sessionId" type="text" placeholder="id" class="form-control"><br>
    <input id="populationSize" type="number" placeholder="population size" class="form-control"><br>
    <input id="groupSize" type="number" placeholder="group size"  class="form-control"><br>
    <input id="numberRounds" type="number" placeholder="number rounds"  class="form-control"><br>
    <input id="rule" type="number" placeholder="rule"  class="form-control"><br>
    <input id="date" type="text" placeholder="date"  class="form-control"><br>
    <input id="createNewSession" type="submit" value="create session" class="btn btn-default">
    </div>
  </form>
</template>

<template name="listOfUsers">
  <h3> List of registered users: </h3>
  {{#each userss}}
    {{username}} 
  {{/each}}
</template>

<template name="loginSection">
  <form class="navbar-form navbar-left" role="search" autocomplete="off">
    <div class="form-group">
      <input type="text" class="form-control" placeholder="username" id="loginSectionUsername" >
      <input type="text" class="form-control" placeholder="password" id="loginSectionPassword" >
    </div>
    <button type="submit" class="btn btn-default"  id="loginSectionLogin" >login</button>
  </form>
</template>

<template name="players">
  <h3> List of corresponding players </h3>
  <table class="table table-condensed" border="1">
  <thead>
    <tr>
  <td>Player ID</td>
  <td>Rounds Played</td>  
  <td>Actual Group</td>  
  <td>Password</td>  
  <td>State</td>  
  <td>List of p played</td>  
  <td>List of q played</td>  
  <td>Rewards</td> 
  </tr>
  </thead>
  {{#each player}}
  <tr>
  <td>{{idPlayer}}</td>
  <td>{{timesPlayed}}</td>  
  <td>{{actualGroup}}</td>  
  <td>{{password}}</td>  
  <td>{{state}}</td>  
  <td>{{pPlayed}}</td>  
  <td>{{qPlayed}}</td>  
  <td>{{reward}}</td> 
  </tr>
  {{/each}}
  </table>
</template>

<template name="groupCapacity">
  <h3> List of sessions and groups registered </h3>
  <table class="table table-condensed" border="1">
  <thead>
    <tr>
    <td>Session ID</td> <td>Rule (A)</td> <td>Groups and Remaining Capacity</td>  <td>Number of saved strategies on each group </td>
    </tr>  
    </thead>
  {{#each sessions}}
    <tr>
    <td>{{idSession}}</td> <td>{{rule}}</td>  <td>{{groupCapacity}}</td>  <td>{{receivedStrategiesOnGroup}}</td>
    </tr>  
  {{/each}}
  </table>
</template>

<template name="introduceStrategy">
  <p> Please, introduce your strategy: </p>
  <form aligh="center" role="form">
  <div class="form-group" style="width:20%">
    <input id="pValue" type="number" placeholder="offer"  class="form-control"><br>
    <input id="qValue" type="number" placeholder="accept above"  class="form-control"><br>
    <input id="submitStrategy" type="submit" value="submit" class="btn btn-default">
    </div>
  </form>
</template>
